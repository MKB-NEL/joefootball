<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Joe Football Club - Admin Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        body { font-family: 'Montserrat', sans-serif; }
        .spinner-border {
            display: none;
            border: 2px solid currentColor;
            border-top-color: transparent;
            border-radius: 50%;
            width: 1rem;
            height: 1rem;
            animation: spin 0.75s linear infinite;
        }
        .loading .spinner-border { display: inline-block; }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto px-4 py-8">
        <div class="flex justify-between items-center mb-8">
            <h1 class="text-3xl font-bold text-blue-900">Admin Panel - Joe Football Club</h1>
            <a href="index.html" class="text-blue-700 hover:text-blue-900 font-medium flex items-center">
                Back to Site <i class="fas fa-arrow-right ml-2"></i>
            </a>
        </div>

        <!-- News Form -->
        <div class="bg-white p-6 rounded-lg shadow-md mb-8">
            <h2 class="text-2xl font-bold mb-4 text-blue-900">Add News</h2>
            <form id="news-form">
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Title</label>
                    <input type="text" id="news-title" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Category</label>
                    <input type="text" id="news-category" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g., Match Report, Transfer">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Content</label>
                    <textarea id="news-content" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" rows="5" required></textarea>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Image</label>
                    <input type="file" id="news-image" accept="image/*" class="w-full">
                </div>
                <button type="submit" class="bg-blue-700 text-white px-6 py-2 rounded-md hover:bg-blue-800 flex items-center">
                    Submit
                    <span class="spinner-border ml-2"></span>
                </button>
            </form>
        </div>

        <!-- Player Form -->
        <div class="bg-white p-6 rounded-lg shadow-md mb-8">
            <h2 class="text-2xl font-bold mb-4 text-blue-900">Add Player</h2>
            <form id="player-form">
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Name</label>
                    <input type="text" id="player-name" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Number</label>
                    <input type="number" id="player-number" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required min="1" max="99">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Position</label>
                    <input type="text" id="player-position" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required placeholder="e.g., Goalkeeper, Midfielder">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Nationality</label>
                    <input type="text" id="player-nationality" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Role (Optional)</label>
                    <input type="text" id="player-role" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g., Captain, Vice-Captain">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Image</label>
                    <input type="file" id="player-image" accept="image/*" class="w-full">
                </div>
                <button type="submit" class="bg-blue-700 text-white px-6 py-2 rounded-md hover:bg-blue-800 flex items-center">
                    Submit
                    <span class="spinner-border ml-2"></span>
                </button>
            </form>
        </div>

        <!-- Gallery Form -->
        <div class="bg-white p-6 rounded-lg shadow-md mb-8">
            <h2 class="text-2xl font-bold mb-4 text-blue-900">Add Gallery Image</h2>
            <form id="gallery-form">
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Description</label>
                    <input type="text" id="gallery-description" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Image</label>
                    <input type="file" id="gallery-image" accept="image/*" class="w-full" required>
                </div>
                <button type="submit" class="bg-blue-700 text-white px-6 py-2 rounded-md hover:bg-blue-800 flex items-center">
                    Submit
                    <span class="spinner-border ml-2"></span>
                </button>
            </form>
        </div>

        <!-- Coach Form -->
        <div class="bg-white p-6 rounded-lg shadow-md mb-8">
            <h2 class="text-2xl font-bold mb-4 text-blue-900">Update Coach</h2>
            <form id="coach-form">
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Name</label>
                    <input type="text" id="coach-name" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Speech</label>
                    <textarea id="coach-speech" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" rows="4"></textarea>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Badges (comma-separated)</label>
                    <input type="text" id="coach-badges" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g., Tactician, Leader">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Achievements</label>
                    <input type="text" id="coach-achievements" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g., 5 League Titles">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Image</label>
                    <input type="file" id="coach-image" accept="image/*" class="w-full">
                </div>
                <button type="submit" class="bg-blue-700 text-white px-6 py-2 rounded-md hover:bg-blue-800 flex items-center">
                    Submit
                    <span class="spinner-border ml-2"></span>
                </button>
            </form>
        </div>

        <!-- Next Match Form -->
        <div class="bg-white p-6 rounded-lg shadow-md mb-8">
            <h2 class="text-2xl font-bold mb-4 text-blue-900">Update Next Match</h2>
            <form id="match-form">
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Home Team</label>
                    <input type="text" id="match-home-team" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Away Team</label>
                    <input type="text" id="match-away-team" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Competition</label>
                    <input type="text" id="match-competition" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Date</label>
                    <input type="text" id="match-date" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required placeholder="e.g., SAT, MAY 20">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Time</label>
                    <input type="text" id="match-time" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required placeholder="e.g., 19:45">
                </div>
                <button type="submit" class="bg-blue-700 text-white px-6 py-2 rounded-md hover:bg-blue-800 flex items-center">
                    Submit
                    <span class="spinner-border ml-2"></span>
                </button>
            </form>
        </div>

        <!-- Stats Form -->
        <div class="bg-white p-6 rounded-lg shadow-md mb-8">
            <h2 class="text-2xl font-bold mb-4 text-blue-900">Update Stats</h2>
            <form id="stats-form">
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Matches</label>
                    <input type="number" id="stats-matches" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required min="0">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Wins</label>
                    <input type="number" id="stats-wins" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required min="0">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Goals</label>
                    <input type="number" id="stats-goals" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required min="0">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Points</label>
                    <input type="number" id="stats-points" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required min="0">
                </div>
                <button type="submit" class="bg-blue-700 text-white px-6 py-2 rounded-md hover:bg-blue-800 flex items-center">
                    Submit
                    <span class="spinner-border ml-2"></span>
                </button>
            </form>
        </div>

        <!-- Sponsor Form -->
        <div class="bg-white p-6 rounded-lg shadow-md mb-8">
            <h2 class="text-2xl font-bold mb-4 text-blue-900">Add Sponsor</h2>
            <form id="sponsor-form">
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Name</label>
                    <input type="text" id="sponsor-name" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Image</label>
                    <input type="file" id="sponsor-image" accept="image/*" class="w-full" required>
                </div>
                <button type="submit" class="bg-blue-700 text-white px-6 py-2 rounded-md hover:bg-blue-800 flex items-center">
                    Submit
                    <span class="spinner-border ml-2"></span>
                </button>
            </form>
        </div>

        <!-- Social Links Form -->
        <div class="bg-white p-6 rounded-lg shadow-md mb-8">
            <h2 class="text-2xl font-bold mb-4 text-blue-900">Update Social Links</h2>
            <form id="social-form">
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Facebook</label>
                    <input type="url" id="social-facebook" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="https://facebook.com/...">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Twitter</label>
                    <input type="url" id="social-twitter" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="https://twitter.com/...">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Instagram</label>
                    <input type="url" id="social-instagram" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="https://instagram.com/...">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">YouTube</label>
                    <input type="url" id="social-youtube" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="https://youtube.com/...">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">TikTok</label>
                    <input type="url" id="social-tiktok" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="https://tiktok.com/...">
                </div>
                <button type="submit" class="bg-blue-700 text-white px-6 py-2 rounded-md hover:bg-blue-800 flex items-center">
                    Submit
                    <span class="spinner-border ml-2"></span>
                </button>
            </form>
        </div>

        <!-- Footer Form -->
        <div class="bg-white p-6 rounded-lg shadow-md mb-8">
            <h2 class="text-2xl font-bold mb-4 text-blue-900">Update Footer</h2>
            <form id="footer-form">
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Footer Text</label>
                    <input type="text" id="footer-text" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required placeholder="e.g., © 2025 Joe Football Club">
                </div>
                <button type="submit" class="bg-blue-700 text-white px-6 py-2 rounded-md hover:bg-blue-800 flex items-center">
                    Submit
                    <span class="spinner-border ml-2"></span>
                </button>
            </form>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, doc, setDoc, Timestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyB3fNRSIEooqL1FZe-MQTzx2e7AntRvfJs85o",
            authDomain: "joefootball-15e7a.firebaseapp.com",
            projectId: "joefootball-15e7a",
            storageBucket: "joefootball-15e7a.appspot.com",
            messagingSenderId: "976347287101",
            appId: "1:976347287101:web:3e8d5f7e8d5f7e8d5f7e8d",
            measurementId: "G-9ZD2Y7CK35Z"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const IMGBB_API_KEY = '5f06b308b918d5a7ef3c4f418da95032';

        // Show loading spinner
        function showLoading(button) {
            button.classList.add('loading');
            button.disabled = true;
        }

        // Hide loading spinner
        function hideLoading(button) {
            button.classList.remove('loading');
            button.disabled = false;
        }

        // Upload image to ImgBB
        async function uploadImage(file) {
            if (!file) return null;
            const formData = new FormData();
            formData.append('image', file);
            try {
                const response = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_API_KEY}`, {
                    method: 'POST',
                    body: formData
                });
                const data = await response.json();
                if (data.success) {
                    return data.data.url;
                } else {
                    throw new Error(data.error.message);
                }
            } catch (e) {
                console.error('Image upload error: ', e);
                return null;
            }
        }

        // News form submission
        document.getElementById('news-form').addEventListener('submit', async e => {
            e.preventDefault();
            const button = e.target.querySelector('button');
            showLoading(button);
            const title = document.getElementById('news-title').value.trim();
            const category = document.getElementById('news-category').value.trim();
            const content = document.getElementById('news-content').value.trim();
            const imageFile = document.getElementById('news-image').files[0];
            try {
                const imageUrl = await uploadImage(imageFile);
                await addDoc(collection(db, 'news'), {
                    title,
                    category: category || 'General',
                    content,
                    image: imageUrl,
                    timestamp: Timestamp.now()
                });
                alert('News added successfully!');
                e.target.reset();
            } catch (e) {
                alert('Error adding news: ' + e.message);
            } finally {
                hideLoading(button);
            }
        });

        // Player form submission
        document.getElementById('player-form').addEventListener('submit', async e => {
            e.preventDefault();
            const button = e.target.querySelector('button');
            showLoading(button);
            const name = document.getElementById('player-name').value.trim();
            const number = parseInt(document.getElementById('player-number').value);
            const position = document.getElementById('player-position').value.trim();
            const nationality = document.getElementById('player-nationality').value.trim();
            const role = document.getElementById('player-role').value.trim();
            const imageFile = document.getElementById('player-image').files[0];
            try {
                const imageUrl = await uploadImage(imageFile);
                await addDoc(collection(db, 'players'), {
                    name,
                    number,
                    position,
                    nationality,
                    role: role || null,
                    image: imageUrl,
                    timestamp: Timestamp.now()
                });
                alert('Player added successfully!');
                e.target.reset();
            } catch (e) {
                alert('Error adding player: ' + e.message);
            } finally {
                hideLoading(button);
            }
        });

        // Gallery form submission
        document.getElementById('gallery-form').addEventListener('submit', async e => {
            e.preventDefault();
            const button = e.target.querySelector('button');
            showLoading(button);
            const description = document.getElementById('gallery-description').value.trim();
            const imageFile = document.getElementById('gallery-image').files[0];
            try {
                const imageUrl = await uploadImage(imageFile);
                if (!imageUrl) throw new Error('Image upload failed');
                await addDoc(collection(db, 'gallery'), {
                    description,
                    image: imageUrl,
                    timestamp: Timestamp.now()
                });
                alert('Gallery image added successfully!');
                e.target.reset();
            } catch (e) {
                alert('Error adding gallery image: ' + e.message);
            } finally {
                hideLoading(button);
            }
        });

        // Coach form submission
        document.getElementById('coach-form').addEventListener('submit', async e => {
            e.preventDefault();
            const button = e.target.querySelector('button');
            showLoading(button);
            const name = document.getElementById('coach-name').value.trim();
            const speech = document.getElementById('coach-speech').value.trim();
            const badges = document.getElementById('coach-badges').value.trim().split(',').map(b => b.trim()).filter(b => b);
            const achievements = document.getElementById('coach-achievements').value.trim();
            const imageFile = document.getElementById('coach-image').files[0];
            try {
                const imageUrl = await uploadImage(imageFile);
                await setDoc(doc(db, 'settings', 'coach'), {
                    name,
                    speech: speech || null,
                    badges: badges.length ? badges : [],
                    achievements: achievements || null,
                    image: imageUrl || null
                });
                alert('Coach updated successfully!');
                e.target.reset();
            } catch (e) {
                alert('Error updating coach: ' + e.message);
            } finally {
                hideLoading(button);
            }
        });

        // Match form submission
        document.getElementById('match-form').addEventListener('submit', async e => {
            e.preventDefault();
            const button = e.target.querySelector('button');
            showLoading(button);
            const homeTeam = document.getElementById('match-home-team').value.trim();
            const awayTeam = document.getElementById('match-away-team').value.trim();
            const competition = document.getElementById('match-competition').value.trim();
            const date = document.getElementById('match-date').value.trim();
            const time = document.getElementById('match-time').value.trim();
            try {
                await setDoc(doc(db, 'settings', 'nextMatch'), {
                    homeTeam,
                    awayTeam,
                    competition,
                    date,
                    time,
                    timestamp: Timestamp.now()
                });
                alert('Next match updated successfully!');
                e.target.reset();
            } catch (e) {
                alert('Error updating match: ' + e.message);
            } finally {
                hideLoading(button);
            }
        });

        // Stats form submission
        document.getElementById('stats-form').addEventListener('submit', async e => {
            e.preventDefault();
            const button = e.target.querySelector('button');
            showLoading(button);
            const matches = parseInt(document.getElementById('stats-matches').value);
            const wins = parseInt(document.getElementById('stats-wins').value);
            const goals = parseInt(document.getElementById('stats-goals').value);
            const points = parseInt(document.getElementById('stats-points').value);
            try {
                await setDoc(doc(db, 'settings', 'stats'), {
                    matches,
                    wins,
                    goals,
                    points,
                    timestamp: Timestamp.now()
                });
                alert('Stats updated successfully!');
                e.target.reset();
            } catch (e) {
                alert('Error updating stats: ' + e.message);
            } finally {
                hideLoading(button);
            }
        });

        // Sponsor form submission
        document.getElementById('sponsor-form').addEventListener('submit', async e => {
            e.preventDefault();
            const button = e.target.querySelector('button');
            showLoading(button);
            const name = document.getElementById('sponsor-name').value.trim();
            const imageFile = document.getElementById('sponsor-image').files[0];
            try {
                const imageUrl = await uploadImage(imageFile);
                if (!imageUrl) throw new Error('Image upload failed');
                await addDoc(collection(db, 'sponsors'), {
                    name,
                    image: imageUrl,
                    timestamp: Timestamp.now()
                });
                alert('Sponsor added successfully!');
                e.target.reset();
            } catch (e) {
                alert('Error adding sponsor: ' + e.message);
            } finally {
                hideLoading(button);
            }
        });

        // Social links form submission
        document.getElementById('social-form').addEventListener('submit', async e => {
            e.preventDefault();
            const button = e.target.querySelector('button');
            showLoading(button);
            const socialLinks = {
                facebook: document.getElementById('social-facebook').value.trim() || null,
                twitter: document.getElementById('social-twitter').value.trim() || null,
                instagram: document.getElementById('social-instagram').value.trim() || null,
                youtube: document.getElementById('social-youtube').value.trim() || null,
                tiktok: document.getElementById('social-tiktok').value.trim() || null
            };
            try {
                await setDoc(doc(db, 'settings', 'social'), {
                    ...socialLinks,
                    timestamp: Timestamp.now()
                });
                alert('Social links updated successfully!');
                e.target.reset();
            } catch (e) {
                alert('Error updating social links: ' + e.message);
            } finally {
                hideLoading(button);
            }
        });

        // Footer form submission
        document.getElementById('footer-form').addEventListener('submit', async e => {
            e.preventDefault();
            const button = e.target.querySelector('button');
            showLoading(button);
            const text = document.getElementById('footer-text').value.trim();
            try {
                await setDoc(doc(db, 'settings', 'footer'), {
                    text,
                    timestamp: Timestamp.now()
                });
                alert('Footer updated successfully!');
                e.target.reset();
            } catch (e) {
                alert('Error updating footer: ' + e.message);
            } finally {
                hideLoading(button);
            }
        });
    </script>
</body>
</html>
