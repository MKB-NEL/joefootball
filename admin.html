<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Admin Dashboard for Joe Football Club">
    <title>Joe Football - Admin Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        :root {
            --primary-color: #1a3e72;
            --secondary-color: #f5a623;
            --dark-color: #0a1f3d;
            --light-color: #f8f9fa;
            --accent-color: #e63946;
            --text-dark: #333;
            --text-light: #f8f9fa;
        }
        
        * {
            font-family: 'Montserrat', sans-serif;
            box-sizing: border-box;
        }
        
        body {
            background-color: var(--light-color);
            color: var(--text-dark);
        }
        
        .navbar {
            background-color: var(--primary-color);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .navbar-brand {
            font-size: 1.8rem;
            font-weight: 900;
            color: white;
        }
        
        .nav-link {
            color: white !important;
            font-weight: 600;
        }
        
        .admin-section {
            padding: 5rem 0;
        }
        
        .section-title {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--primary-color);
            margin-bottom: 3rem;
            text-transform: uppercase;
            position: relative;
            display: inline-block;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 60px;
            height: 4px;
            background-color: var(--secondary-color);
        }
        
        .admin-card {
            background-color: white;
            border-radius: 10px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .admin-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--secondary-color);
        }
        
        .form-control {
            padding: 1rem;
            border-radius: 5px;
            border: 1px solid #ddd;
            margin-bottom: 1.5rem;
        }
        
        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.25rem rgba(26, 62, 114, 0.25);
        }
        
        .btn-primary {
            background-color: var(--secondary-color);
            border: none;
            padding: 0.75rem 2rem;
            font-weight: 600;
            text-transform: uppercase;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-color);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        @media (max-width: 768px) {
            .section-title {
                font-size: 2rem;
            }
            
            .admin-title {
                font-size: 1.3rem;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="index.html">JOE FOOTBALL</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link active" href="#">Admin</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <section class="admin-section">
        <div class="container">
            <h2 class="section-title text-center">Admin Dashboard</h2>
            <div class="row">
                <div class="col-md-6">
                    <div class="admin-card">
                        <h3 class="admin-title">Social Media Links</h3>
                        <form id="social-form">
                            <div class="mb-3">
                                <label for="instagram" class="form-label">Instagram URL</label>
                                <input type="url" class="form-control" id="instagram" placeholder="https://instagram.com/joefootball">
                            </div>
                            <div class="mb-3">
                                <label for="youtube" class="form-label">YouTube URL</label>
                                <input type="url" class="form-control" id="youtube" placeholder="https://youtube.com/joefootball">
                            </div>
                            <div class="mb-3">
                                <label for="twitter" class="form-label">Twitter URL</label>
                                <input type="url" class="form-control" id="twitter" placeholder="https://twitter.com/joefootball">
                            </div>
                            <div class="mb-3">
                                <label for="facebook" class="form-label">Facebook URL</label>
                                <input type="url" class="form-control" id="facebook" placeholder="https://facebook.com/joefootball">
                            </div>
                            <button type="submit" class="btn btn-primary">Save Links</button>
                        </form>
                    </div>
                    <div class="admin-card">
                        <h3 class="admin-title">Update Coach</h3>
                        <form id="coach-form">
                            <div class="mb-3">
                                <label for="coach-name-input" class="form-label">Name</label>
                                <input type="text" class="form-control" id="coach-name-input" placeholder="Coach Name" required>
                            </div>
                            <div class="mb-3">
                                <label for="coach-title-input" class="form-label">Title</label>
                                <input type="text" class="form-control" id="coach-title-input" placeholder="Head Coach" required>
                            </div>
                            <div class="mb-3">
                                <label for="coach-speech-input" class="form-label">Speech</label>
                                <textarea class="form-control" id="coach-speech-input" rows="4" required></textarea>
                            </div>
                            <div class="mb-3">
                                <label for="coach-badges" class="form-label">Badges (comma separated)</label>
                                <input type="text" class="form-control" id="coach-badges" placeholder="UEFA Pro License, 15 Years Experience">
                            </div>
                            <div class="mb-3">
                                <label for="coach-image" class="form-label">Image</label>
                                <input type="file" class="form-control" id="coach-image" accept="image/*">
                            </div>
                            <button type="submit" class="btn btn-primary">Update Coach</button>
                        </form>
                    </div>
                    <div class="admin-card">
                        <h3 class="admin-title">Add Player</h3>
                        <form id="player-form">
                            <div class="mb-3">
                                <label for="player-name" class="form-label">Name</label>
                                <input type="text" class="form-control" id="player-name" placeholder="Player Name" required>
                            </div>
                            <div class="mb-3">
                                <label for="nationality" class="form-label">Nationality</label>
                                <input type="text" class="form-control" id="nationality" placeholder="Country" required>
                            </div>
                            <div class="mb-3">
                                <label for="position" class="form-label">Position</label>
                                <input type="text" class="form-control" id="position" placeholder="Position" required>
                            </div>
                            <div class="mb-3">
                                <label for="player-image" class="form-label">Image</label>
                                <input type="file" class="form-control" id="player-image" accept="image/*" required>
                            </div>
                            <button type="submit" class="btn btn-primary">Add Player</button>
                        </form>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="admin-card">
                        <h3 class="admin-title">Add Gallery Image</h3>
                        <form id="gallery-form">
                            <div class="mb-3">
                                <label for="gallery-image" class="form-label">Image</label>
                                <input type="file" class="form-control" id="gallery-image" accept="image/*" required>
                            </div>
                            <div class="mb-3">
                                <label for="gallery-description" class="form-label">Description</label>
                                <input type="text" class="form-control" id="gallery-description" placeholder="Image description" required>
                            </div>
                            <button type="submit" class="btn btn-primary">Add Image</button>
                        </form>
                    </div>
                    <div class="admin-card">
                        <h3 class="admin-title">Add News</h3>
                        <form id="news-form">
                            <div class="mb-3">
                                <label for="news-title" class="form-label">Title</label>
                                <input type="text" class="form-control" id="news-title" placeholder="News title" required>
                            </div>
                            <div class="mb-3">
                                <label for="news-content" class="form-label">Content</label>
                                <textarea class="form-control" id="news-content" rows="5" required></textarea>
                            </div>
                            <div class="mb-3">
                                <label for="news-image" class="form-label">Image</label>
                                <input type="file" class="form-control" id="news-image" accept="image/*">
                            </div>
                            <button type="submit" class="btn btn-primary">Add News</button>
                        </form>
                    </div>
                    <div class="admin-card">
                        <h3 class="admin-title">Update Footer</h3>
                        <form id="footer-form">
                            <div class="mb-3">
                                <label for="footer-text-input" class="form-label">Footer Text</label>
                                <input type="text" class="form-control" id="footer-text-input" placeholder="Copyright text">
                            </div>
                            <button type="submit" class="btn btn-primary">Update Footer</button>
                        </form>
                    </div>
                    <div class="admin-card">
                        <h3 class="admin-title">Contact Submissions</h3>
                        <div id="contact-submissions" class="overflow-auto" style="max-height: 300px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, doc, setDoc, addDoc, getDoc, getDocs, query, orderBy, Timestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";

        const firebaseConfig = {
            apiKey: "AIzaSyB3fNRSIEooqL1FZe-MQTzx2e7AntRvfJs85o",
            authDomain: "joefootball-15e7a.firebaseapp.com",
            projectId: "joefootball-15e7a",
            storageBucket: "joefootball-15e7a.appspot.com",
            messagingSenderId: "976347287101",
            appId: "1:976347287101:web:3e8d5f7e8d5f7e8d5f7e8d",
            measurementId: "G-9ZD2Y7CK35Z"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const storage = getStorage(app);
        const IMGBB_API_KEY = '5f06b308b918d5a7ef3c4f418da95032';

        // Load social media links
        async function loadSocialLinks() {
            try {
                const socialDoc = await getDoc(doc(db, 'settings', 'social'));
                if (socialDoc.exists()) {
                    const data = socialDoc.data();
                    document.getElementById('instagram').value = data.instagram || '';
                    document.getElementById('youtube').value = data.youtube || '';
                    document.getElementById('twitter').value = data.twitter || '';
                    document.getElementById('facebook').value = data.facebook || '';
                }
            } catch (e) {
                console.error('Error loading social links: ', e);
            }
        }

        // Save social media links
        document.getElementById('social-form').addEventListener('submit', async e => {
            e.preventDefault();
            try {
                await setDoc(doc(db, 'settings', 'social'), {
                    instagram: document.getElementById('instagram').value,
                    youtube: document.getElementById('youtube').value,
                    twitter: document.getElementById('twitter').value,
                    facebook: document.getElementById('facebook').value
                });
                alert('Social links saved!');
            } catch (e) {
                alert('Error: ' + e.message);
            }
        });

        // Load coach
        async function loadCoach() {
            try {
                const coachDoc = await getDoc(doc(db, 'settings', 'coach'));
                if (coachDoc.exists()) {
                    const data = coachDoc.data();
                    document.getElementById('coach-name-input').value = data.name || '';
                    document.getElementById('coach-title-input').value = data.title || '';
                    document.getElementById('coach-speech-input').value = data.speech || '';
                    document.getElementById('coach-badges').value = data.badges || '';
                }
            } catch (e) {
                console.error('Error loading coach: ', e);
            }
        }

        // Update coach
        document.getElementById('coach-form').addEventListener('submit', async e => {
            e.preventDefault();
            const name = document.getElementById('coach-name-input').value;
            const title = document.getElementById('coach-title-input').value;
            const speech = document.getElementById('coach-speech-input').value;
            const badges = document.getElementById('coach-badges').value;
            const file = document.getElementById('coach-image').files[0];
            let imageUrl = '';
            try {
                if (file) {
                    try {
                        const storageRef = ref(storage, `coach/coach-image-${Date.now()}`);
                        const snapshot = await uploadBytes(storageRef, file);
                        imageUrl = await getDownloadURL(snapshot.ref);
                    } catch (e) {
                        console.warn('Firebase Storage failed, using ImgBB: ', e);
                        const formData = new FormData();
                        formData.append('image', file);
                        const response = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_API_KEY}`, {
                            method: 'POST',
                            body: formData
                        });
                        const data = await response.json();
                        if (data.success) imageUrl = data.data.url;
                        else throw new Error('ImgBB upload failed');
                    }
                }
                const coachDoc = await getDoc(doc(db, 'settings', 'coach'));
                const existingData = coachDoc.exists() ? coachDoc.data() : {};
                await setDoc(doc(db, 'settings', 'coach'), {
                    name, title, speech, badges, image: imageUrl || existingData.image || ''
                });
                alert('Coach updated!');
                loadCoach();
                e.target.reset();
            } catch (e) {
                alert('Error: ' + e.message);
            }
        });

        // Add gallery image
        document.getElementById('gallery-form').addEventListener('submit', async e => {
            e.preventDefault();
            const file = document.getElementById('gallery-image').files[0];
            const description = document.getElementById('gallery-description').value;
            try {
                let imageUrl = '';
                try {
                    const storageRef = ref(storage, `gallery/gallery-image-${Date.now()}`);
                    const snapshot = await uploadBytes(storageRef, file);
                    imageUrl = await getDownloadURL(snapshot.ref);
                } catch (e) {
                    console.warn('Firebase Storage failed, using ImgBB: ', e);
                    const formData = new FormData();
                    formData.append('image', file);
                    const response = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_API_KEY}`, {
                        method: 'POST',
                        body: formData
                    });
                    const data = await response.json();
                    if (data.success) imageUrl = data.data.url;
                    else throw new Error('ImgBB upload failed');
                }
                await addDoc(collection(db, 'gallery'), { image: imageUrl, description, timestamp: Timestamp.now() });
                alert('Image added!');
                e.target.reset();
            } catch (e) {
                alert('Error: ' + e.message);
            }
        });

        // Add news
        document.getElementById('news-form').addEventListener('submit', async e => {
            e.preventDefault();
            const title = document.getElementById('news-title').value;
            const content = document.getElementById('news-content').value;
            const file = document.getElementById('news-image').files[0];
            let imageUrl = '';
            try {
                if (file) {
                    try {
                        const storageRef = ref(storage, `news/news-image-${Date.now()}`);
                        const snapshot = await uploadBytes(storageRef, file);
                        imageUrl = await getDownloadURL(snapshot.ref);
                    } catch (e) {
                        console.warn('Firebase Storage failed, using ImgBB: ', e);
                        const formData = new FormData();
                        formData.append('image', file);
                        const response = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_API_KEY}`, {
                            method: 'POST',
                            body: formData
                        });
                        const data = await response.json();
                        if (data.success) imageUrl = data.data.url;
                        else throw new Error('ImgBB upload failed');
                    }
                }
                await addDoc(collection(db, 'news'), { title, content, image: imageUrl, timestamp: Timestamp.now() });
                alert('News added!');
                e.target.reset();
            } catch (e) {
                alert('Error: ' + e.message);
            }
        });

        // Add player
        document.getElementById('player-form').addEventListener('submit', async e => {
            e.preventDefault();
            const name = document.getElementById('player-name').value;
            const nationality = document.getElementById('nationality').value;
            const position = document.getElementById('position').value;
            const file = document.getElementById('player-image').files[0];
            try {
                let imageUrl = '';
                try {
                    const storageRef = ref(storage, `players/player-${Date.now()}`);
                    const snapshot = await uploadBytes(storageRef, file);
                    imageUrl = await getDownloadURL(snapshot.ref);
                } catch (e) {
                    console.warn('Firebase Storage failed, using ImgBB: ', e);
                    const formData = new FormData();
                    formData.append('image', file);
                    const response = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_API_KEY}`, {
                        method: 'POST',
                        body: formData
                    });
                    const data = await response.json();
                    if (data.success) imageUrl = data.data.url;
                    else throw new Error('ImgBB upload failed');
                }
                await addDoc(collection(db, 'players'), { name, nationality, position, image: imageUrl });
                alert('Player added!');
                e.target.reset();
            } catch (e) {
                alert('Error: ' + e.message);
            }
        });

        // Load contact submissions
        async function loadContactSubmissions() {
            try {
                const contactSnapshot = await getDocs(query(collection(db, 'contactSubmissions'), orderBy('timestamp', 'desc')));
                const container = document.getElementById('contact-submissions');
                container.innerHTML = '';
                if (contactSnapshot.empty) {
                    container.innerHTML = '<p>No submissions yet</p>';
                    return;
                }
                contactSnapshot.forEach(doc => {
                    const submission = doc.data();
                    const date = submission.timestamp.toDate().toLocaleString();
                    container.innerHTML += `
                        <div class="card mb-3">
                            <div class="card-body">
                                <h6 class="card-subtitle mb-2 text-muted">${date}</h6>
                                <h5 class="card-title">${submission.name}</h5>
                                <h6 class="card-subtitle mb-2 text-primary">${submission.email}</h6>
                                ${submission.subject ? `<h6 class="card-subtitle mb-2">${submission.subject}</h6>` : ''}
                                <p class="card-text">${submission.message}</p>
                            </div>
                        </div>
                    `;
                });
            } catch (e) {
                console.error('Error loading contact submissions: ', e);
            }
        }

        // Update footer
        document.getElementById('footer-form').addEventListener('submit', async e => {
            e.preventDefault();
            const text = document.getElementById('footer-text-input').value;
            try {
                await setDoc(doc(db, 'settings', 'footer'), { text });
                alert('Footer updated!');
            } catch (e) {
                alert('Error: ' + e.message);
            }
        });

        // Load footer
        async function loadFooter() {
            try {
                const footerDoc = await getDoc(doc(db, 'settings', 'footer'));
                if (footerDoc.exists()) {
                    document.getElementById('footer-text-input').value = footerDoc.data().text || '';
                }
            } catch (e) {
                console.error('Error loading footer: ', e);
            }
        }

        // Initialize
        async function init() {
            await loadSocialLinks();
            await loadCoach();
            await loadContactSubmissions();
            await loadFooter();
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
